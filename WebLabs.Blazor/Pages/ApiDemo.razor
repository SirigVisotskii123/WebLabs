@page "/apidemo"
@inject HttpClient Http

@using WebLabs.Blazor.Data
<div class="container">
	<WebLabs.Blazor.Components.DishesList @bind-Dishes="dishes"
	SelectedObjectChanged="ShowDetails"></WebLabs.Blazor.Components.DishesList>

<WebLabs.Blazor.Components.DishDetails @bind-Dish="SelectedDish"></WebLabs.Blazor.Components.DishDetails>
</div>
<p>api demo @Http.BaseAddress</p>


@code {
	// [Parameter]
	// public IEnumerable<ListViewModel> dishes { get; set; }
	string apiBaseAddress = "https://localhost:7147/Api/Dishes";

	//HttpClient clientFactory;
	protected override async Task OnInitializedAsync()
	{
		//Http.BaseAddress;
		//Http.Json
		dishes = await Http.GetFromJsonAsync<IEnumerable<ListViewModel>>(apiBaseAddress);//"sample-data/json_json.json");
	}

	[Parameter]
	public IEnumerable<ListViewModel>? dishes { get; set; }
	[Parameter]
	public EventCallback<IEnumerable<ListViewModel>> DishesChanged
	{
		get; set;
	}

	[Parameter]
	public DetailsViewModel SelectedDish { get; set; }
	private async Task ShowDetails(int id)
	{
		SelectedDish = await Http.GetFromJsonAsync<DetailsViewModel>(apiBaseAddress + $"/{id}");
	}
}
